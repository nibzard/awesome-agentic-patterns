{
  "title": "Coding Agent CI Feedback Loop",
  "status": "best-practice",
  "authors": ["Nikola Balic (@nibzard)"],
  "based_on": ["Quinn Slack (Concept)", "Will Brown (Prime Intellect Talk)"],
  "category": "Feedback Loops",
  "source": "https://www.youtube.com/watch?v=Xkwok_XXQgw",
  "tags": ["CI", "coding-agent", "asynchronous", "test-driven", "feedback"],
  "slug": "coding-agent-ci-feedback-loop",
  "id": "coding-agent-ci-feedback-loop",
  "summary": "TODO: Add a concise summary for \"Coding Agent CI Feedback Loop\" describing the pattern's purpose and key benefits.",
  "updated_at": "2026-01-05",
  "body": "\n## Problem\n\nWhen a coding agent tackles multi-file refactors or feature additions, running tests and waiting for test feedback **synchronously** ties up compute and prevents the agent from working on parallel tasks. The agent cannot easily improve code if it must halt until the entire suite finishes.\n\n- Traditional CI loops block further edits; the agent \"babysits\" the build until tests pass.\n- Long test suites introduce idle periods, leading to underutilized GPUs and inflated RL training times.\n\n## Solution\n\nRun the coding agent **asynchronously** against CI (local or remote), allowing it to:\n\n**1. Push a Branch & Trigger Tests**\n- When the agent proposes a patch, it commits to a branch and triggers the CI pipeline (e.g., `git push && github_action_run`).\n\n**2. Ingest Partial CI Feedback**\n- As tests begin, the agent periodically polls CI results.\n- **Failed Tests Partial Report:** Receive a small subset of failures (e.g., 10% of failures flagged first).\n\n**3. Iterative Patch Refinement**\n- Use test failure outputs (stack traces, error messages) as **machine-readable feedback**.\n- Agent autonomously applies fixes to specific files or functions without human intervention.\n\n**4. Ping on Final Green**\n- When all tests pass, send a notification (e.g., chat or pull request comment) that the PR is ready for review.\n\n## Example\n\n```mermaid\nsequenceDiagram\n  Agent->>GitRepo: create branch coding-agent-refactor\n  Agent->>CI: trigger tests remotely\n  loop every 30s\n    CI-->>Agent: partial failures or success chunk\n    Agent->>Files: patch specific failures\n    Agent->>CI: re-run only failing tests\n  end\n  CI-->>Agent: âœ… all tests green\n  Agent-->>User: \"PR is ready to merge\"\n```\n\n## How to use it\n\n- **CI Integration:** Provide the agent with a CLI or API key to push branches and trigger tests (e.g., via GitHub Actions or Jenkins).\n- **Error Parsing Modules:** Implement a small parser that translates CI logs into structured diagnostics (e.g., `{file: \"auth.py\", line: 42, error: \"Expected status 200\"}`).\n- **Prioritized Test Runs:** When re-running, only run tests in files that were patched, to reduce CI time.\n\n## Trade-offs\n\n- **Pros:**\n  - **Compute Efficiency:** Overlaps code generation and test runs across multiple agents or branches.\n  - **Faster Iteration:** Agent spends less time waiting and more time generating code.\n  - **Autonomy:** Reduces need for human intervention until final green.\n- **Cons/Considerations:**\n  - **CI Flakiness:** Intermittent test failures can mislead the agent into unnecessary patches unless flakiness detection is in place.\n  - **Security:** Agent requires permission to push and read CI logs, which may expose sensitive data if misconfigured.\n\n## References\n\n- Inspired by \"Background Agent with CI Feedback\" pattern, adapted for coding-specific workflows.\n- Will Brown's emphasis on **asynchronous pipelines** to avoid idle compute bubbles.\n"
}
