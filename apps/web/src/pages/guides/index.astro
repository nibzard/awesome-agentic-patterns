---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

// Get all guides
const guides = await getCollection('guides');

// Sort guides by order if available, otherwise by title
const sortedGuides = guides.sort((a, b) => {
  const aOrder = a.data.order ?? 999;
  const bOrder = b.data.order ?? 999;
  if (aOrder !== bOrder) return aOrder - bOrder;
  return a.data.title.localeCompare(b.data.title);
});
---

<BaseLayout title="Guides - Awesome Agentic Patterns">
  <div class="guides-page">
    <header class="guides-header">
      <h1>Guides</h1>
      <p class="guides-subtitle">
        In-depth resources to help you understand and implement AI agent design patterns.
      </p>
    </header>

    <div class="guides-intro">
      <p>
        These guides provide detailed explanations, practical examples, and implementation
        advice for working with AI agent design patterns. Whether you're just getting started
        or looking to deepen your understanding, you'll find valuable resources here.
      </p>
    </div>

    <div class="guides-list">
      {sortedGuides.map((guide) => (
        <a href={`/guides/${guide.slug}`} class="guide-card">
          <div class="guide-card-content">
            <h2 class="guide-title">{guide.data.title}</h2>
            <p class="guide-description">{guide.data.description}</p>
          </div>

          <div class="guide-card-footer">
            <span class="guide-link">Read Guide â†’</span>
          </div>
        </a>
      ))}
    </div>

    {sortedGuides.length === 0 && (
      <div class="guides-empty">
        <svg width="64" height="64" viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg">
          <rect width="64" height="64" rx="32" fill="var(--color-border)"/>
          <path d="M20 32H44M32 20V44" stroke="var(--color-text-muted)" stroke-width="2" stroke-linecap="round"/>
        </svg>
        <h2>No Guides Yet</h2>
        <p>Guides are coming soon! Check back later for in-depth resources.</p>
      </div>
    )}

    <div class="guides-cta">
      <h2>Ready to Explore Patterns?</h2>
      <p>
        Browse our comprehensive catalogue of AI agent design patterns to find the right
        patterns for your use case.
      </p>
      <a href="/patterns" class="button button--primary">
        Browse All Patterns
      </a>
    </div>
  </div>
</BaseLayout>

<style>
  .guides-page {
    max-width: 900px;
    margin: 0 auto;
    padding: var(--spacing-xl) var(--spacing-lg);
  }

  .guides-header {
    text-align: center;
    margin-bottom: var(--spacing-2xl);
  }

  .guides-header h1 {
    font-size: 2.5rem;
    font-weight: 700;
    color: var(--color-text);
    margin-bottom: var(--spacing-md);
  }

  .guides-subtitle {
    font-size: 1.125rem;
    color: var(--color-text-muted);
  }

  .guides-intro {
    max-width: 700px;
    margin: 0 auto var(--spacing-2xl);
    padding: var(--spacing-lg);
    background-color: var(--color-border);
    border-radius: var(--radius-lg);
    text-align: center;
  }

  .guides-intro p {
    color: var(--color-text);
    line-height: 1.6;
    margin: 0;
  }

  .guides-list {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-md);
    margin-bottom: var(--spacing-2xl);
  }

  .guide-card {
    display: flex;
    flex-direction: column;
    padding: var(--spacing-lg);
    background-color: var(--color-bg);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    text-decoration: none;
    color: var(--color-text);
    transition: all 0.2s ease;
  }

  .guide-card:hover {
    border-color: var(--color-primary);
    transform: translateX(4px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
  }

  .guide-card-content {
    flex: 1;
  }

  .guide-title {
    font-size: 1.25rem;
    font-weight: 600;
    color: var(--color-text);
    margin-bottom: var(--spacing-sm);
  }

  .guide-description {
    font-size: 0.9375rem;
    color: var(--color-text-muted);
    line-height: 1.5;
    margin: 0;
  }

  .guide-card-footer {
    margin-top: var(--spacing-md);
    padding-top: var(--spacing-md);
    border-top: 1px solid var(--color-divider);
  }

  .guide-link {
    font-size: 0.875rem;
    font-weight: 500;
    color: var(--color-primary);
  }

  .guide-card:hover .guide-link {
    text-decoration: underline;
  }

  .guides-empty {
    text-align: center;
    padding: var(--spacing-2xl);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    margin-bottom: var(--spacing-2xl);
  }

  .guides-empty svg {
    color: var(--color-text-muted);
    margin-bottom: var(--spacing-md);
  }

  .guides-empty h2 {
    font-size: 1.5rem;
    font-weight: 600;
    color: var(--color-text);
    margin-bottom: var(--spacing-sm);
  }

  .guides-empty p {
    font-size: 1rem;
    color: var(--color-text-muted);
    margin: 0;
  }

  .guides-cta {
    text-align: center;
    padding: var(--spacing-2xl);
    background-color: var(--color-border);
    border-radius: var(--radius-lg);
  }

  .guides-cta h2 {
    font-size: 1.5rem;
    font-weight: 600;
    color: var(--color-text);
    margin-bottom: var(--spacing-sm);
  }

  .guides-cta p {
    font-size: 1rem;
    color: var(--color-text-muted);
    margin-bottom: var(--spacing-lg);
  }

  .button {
    display: inline-block;
    padding: var(--spacing-sm) var(--spacing-xl);
    border: none;
    border-radius: var(--radius-md);
    font-weight: 500;
    text-align: center;
    text-decoration: none;
    transition: all 0.2s ease;
  }

  .button--primary {
    background-color: var(--color-primary);
    color: white;
  }

  .button--primary:hover {
    background-color: var(--color-primary-dark);
    transform: translateY(-1px);
  }

  @media (max-width: 640px) {
    .guides-header h1 {
      font-size: 2rem;
    }
  }
</style>
