---
// ThemeToggle component - switches between light and dark themes
---

<button id="theme-toggle" class="theme-toggle" aria-label="Toggle theme" type="button">
  <svg
    class="sun-icon"
    width="20"
    height="20"
    viewBox="0 0 20 20"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <circle cx="10" cy="10" r="4" stroke="currentColor" stroke-width="2"></circle>
    <path
      d="M10 2V4M10 16V18M18 10H16M4 10H2M15.66 15.66L14.24 14.24M5.76 5.76L4.34 4.34M15.66 4.34L14.24 5.76M5.76 14.24L4.34 15.66"
      stroke="currentColor"
      stroke-width="2"
      stroke-linecap="round"></path>
  </svg>
  <svg
    class="moon-icon"
    width="20"
    height="20"
    viewBox="0 0 20 20"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      d="M17.5 10C17.5 14.1421 14.1421 17.5 10 17.5C5.85786 17.5 2.5 14.1421 2.5 10C2.5 5.85786 5.85786 2.5 10 2.5C10.5144 2.5 11.0156 2.55296 11.4994 2.65434C8.08029 3.32192 5.5 6.27486 5.5 9.83333C5.5 13.7846 8.71536 17 12.6667 17C16.2251 17 19.1781 14.4197 19.8457 11.0006C19.947 11.4844 20 11.9856 20 12.5H17.5V10Z"
      fill="currentColor"></path>
  </svg>
</button>

<style>
  .theme-toggle {
    background: transparent;
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    padding: var(--spacing-sm);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--color-text);
    transition: all 0.2s ease;
  }

  .theme-toggle:hover {
    background-color: var(--color-border);
  }

  .theme-toggle:focus-visible {
    outline: 2px solid var(--color-primary);
    outline-offset: 2px;
  }

  .sun-icon,
  .moon-icon {
    display: none;
  }

  /* Show sun icon in dark mode */
  :global([data-theme='dark']) .theme-toggle .sun-icon {
    display: block;
  }

  @media (prefers-color-scheme: dark) {
    .theme-toggle .sun-icon {
      display: block;
    }
  }

  /* Show moon icon in light mode */
  :global([data-theme='light']) .theme-toggle .moon-icon {
    display: block;
  }

  @media (prefers-color-scheme: light) {
    .theme-toggle .moon-icon {
      display: block;
    }
  }

  /* When theme is explicitly set */
  :global([data-theme='dark']) .theme-toggle .moon-icon {
    display: none;
  }

  :global([data-theme='light']) .theme-toggle .sun-icon {
    display: none;
  }
</style>

<script>
  // Theme toggle functionality
  const themeToggle = document.getElementById('theme-toggle');

  function getTheme(): string {
    if (typeof localStorage !== 'undefined') {
      const stored = localStorage.getItem('theme');
      if (stored) return stored;
    }
    return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
  }

  function setTheme(theme: string): void {
    if (typeof localStorage !== 'undefined') {
      localStorage.setItem('theme', theme);
    }
    document.documentElement.setAttribute('data-theme', theme);
  }

  // Initialize theme
  setTheme(getTheme());

  // Toggle theme on click
  themeToggle?.addEventListener('click', () => {
    const currentTheme = document.documentElement.getAttribute('data-theme') || getTheme();
    const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
    setTheme(newTheme);
  });
</script>
